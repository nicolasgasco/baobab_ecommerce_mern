(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[11],{63:function(e,t,s){"use strict";s.r(t);var r=s(8),a=s.n(r),n=s(16),o=s(2),c=s(0),l=s(4),d=s(18),i=s(19),u=s(22),m=s(15),p=s(13),b=s(1);t.default=function(){var e=Object(c.useContext)(d.a).checkPassword,t=Object(c.useContext)(i.a).handleModalText,s=Object(l.g)(),r=Object(p.a)(),j=r.sendRequest,g=r.isLoading,h=r.setIsLoading,f=Object(m.a)(localStorage.getItem("token")),x=f._id,w=f.email,O=Object(c.useState)(""),y=Object(o.a)(O,2),v=y[0],k=y[1],N=Object(c.useState)(!1),C=Object(o.a)(N,2),S=C[0],F=C[1],P=Object(c.useState)(""),T=Object(o.a)(P,2),_=T[0],q=T[1],A=Object(c.useState)(""),I=Object(o.a)(A,2),J=I[0],L=I[1],B=Object(c.useState)([]),D=Object(o.a)(B,2),E=D[0],H=D[1],M=function(){var t=Object(n.a)(a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(H([]),!S){t.next=3;break}return t.abrupt("return");case 3:if(!localStorage.getItem("token")){t.next=20;break}return h(!0),t.prev=5,console.log("check"),t.next=9,e({email:w,password:v});case 9:(r=t.sent)&&(F(!!r),h(!1)),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(5),console.log(t.t0),h(!1),H(["Wrong password!"]);case 18:t.next=22;break;case 20:s.push("/"),s.go(0);case 22:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(){return t.apply(this,arguments)}}(),R=function(){var e=Object(n.a)(a.a.mark((function e(s){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H([]),s.preventDefault(),_!==J?H(["The two passwords don't match"]):(h(!0),r=function(e){e.error&&(h(!1),H(e.error.split("(Joi): ")[1].split(",").map((function(e){return e.replaceAll('"',"")})))),console.log("Patching passowrd"),1===e.updatedCount&&(h(!1),t("Password changed!"))},j({url:"/api/users/".concat(x),method:"PATCH",headers:{"Content-Type":"application/json"},body:{password:J}},r));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=E.map((function(e){return Object(b.jsx)("li",{children:e.charAt(0).toUpperCase()+e.slice(1)})}));return Object(b.jsxs)(b.Fragment,{children:[g&&Object(b.jsx)(u.a,{}),Object(b.jsx)("div",{className:"md:col-span-1",children:Object(b.jsx)("div",{className:"md:col-span-2",children:Object(b.jsx)("form",{onSubmit:R,children:Object(b.jsxs)("div",{className:"overflow-hidden sm:rounded-md",children:[Object(b.jsx)("div",{className:"px-4 py-5 bg-white sm:p-6",children:Object(b.jsxs)("div",{className:"grid grid-cols-6 gap-6",children:[Object(b.jsxs)("div",{className:"col-span-6 sm:col-span-4",children:[Object(b.jsx)("label",{htmlFor:"email_address",className:"block text-sm font-medium text-gray-700",children:"Current password"}),Object(b.jsx)("input",{type:"password",name:"current-password",id:"current-password",autoComplete:"current-password",disabled:S,value:v,onChange:function(e){F(!1),H([]),k(e.target.value)},onBlur:M,className:"mt-2 p-1 ring-1 ring-gray-300 placeholder-black focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 ".concat(S?"bg-green-100 ring-green-900":v&&"bg-red-100 ring-red-900"," rounded-md")})]}),Object(b.jsxs)("div",{className:"col-span-6 sm:col-span-3 ".concat(!S&&"hidden"),children:[Object(b.jsx)("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700",children:"New password"}),Object(b.jsx)("input",{type:"password",name:"new-password",id:"new-password",autoComplete:"new-password",required:!0,disabled:!S,value:_,onChange:function(e){q(e.target.value)},className:"mt-2 p-1 ring-1 ring-gray-300 placeholder-black focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),Object(b.jsxs)("div",{className:"col-span-6 sm:col-span-3 ".concat(!S&&"hidden"),children:[Object(b.jsx)("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700",children:"Confirm password"}),Object(b.jsx)("input",{type:"password",name:"confirm-password",id:"confirm-password",autoComplete:"new-password",required:!0,disabled:!S,value:J,onChange:function(e){L(e.target.value)},className:"mt-2 p-1 ring-1 ring-gray-300 placeholder-black focus:ring-yellow-500 focus:border-yellow-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]})}),E.length>0&&Object(b.jsxs)("div",{class:"mx-5 bg-red-100 border-l-4 border-red-500 text-red-700 p-4",role:"alert",children:[Object(b.jsx)("h4",{className:"font-bold text-xl",children:"Error"}),Object(b.jsx)("ul",{className:"ml-5 list-disc",children:U})]}),Object(b.jsxs)("div",{className:"px-4 text-right sm:px-6",children:[Object(b.jsx)("button",{type:"button",className:"inline-flex justify-center py-2 px-4 ml-3 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",onClick:function(){s.push("/")},children:"Cancel"}),Object(b.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 ml-3 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Save"})]})]})})})})]})}}}]);
//# sourceMappingURL=11.2437272b.chunk.js.map