(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[3],{79:function(e,t,n){e.exports={root:"CheckoutForm_root__1EsRl",form:"CheckoutForm_form__1STSy",input:"CheckoutForm_input__wcA4t","result-message":"CheckoutForm_result-message__1x9OH",hidden:"CheckoutForm_hidden__1YS0o","card-error":"CheckoutForm_card-error__1Msw_","card-element":"CheckoutForm_card-element__3JPdK","payment-request-button":"CheckoutForm_payment-request-button__3Moir",button:"CheckoutForm_button__TkFTp",spinner:"CheckoutForm_spinner__tkQtG",loading:"CheckoutForm_loading__2ae-_"}},81:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var r=n(15),a=n.n(r),c=n(26),o=n(3),s=n(0),i=n(53),l=n(24),u=n(79),m=n.n(u),d=n(11),b=n(25),p=n(5),j=n(23),h=n(1);function f(){var e=Object(s.useContext)(b.a),t=e.items,n=e.saveOrder,r=(e.userAddress,Object(p.g)()),u=Object(s.useState)(!1),f=Object(o.a)(u,2),_=f[0],x=f[1],O=Object(s.useState)(null),g=Object(o.a)(O,2),v=g[0],k=g[1],y=Object(s.useState)(""),w=Object(o.a)(y,2),C=w[0],S=w[1],F=Object(s.useState)(!0),N=Object(o.a)(F,2),E=N[0],P=N[1],T=Object(s.useState)(""),q=Object(o.a)(T,2),A=q[0],J=q[1],M=Object(i.useStripe)(),R=Object(i.useElements)(),D=Object(j.a)().sendRequest;Object(s.useEffect)((function(){D({url:"/api/order/payment",method:"POST",headers:{"Content-Type":"application/json"},body:{items:t}},(function(e){J(e.clientSecret)}),(function(){S(!1)}))}),[t,D]);var z=function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P(t.empty),k(t.error?t.error.message:"");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(c.a)(a.a.mark((function e(c){var o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),S(!0),e.next=4,M.confirmCardPayment(A,{payment_method:{card:R.getElement(i.CardElement)}});case 4:(o=e.sent).error?(k("Payment failed ".concat(o.error.message)),S(!1)):(s=Object(l.a)(localStorage.getItem("token"))._id,n(s,t),k(null),S(!1),x(!0),r.push("/success"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{className:"w-full mx-auto",style:{maxWidth:"600px"},children:[Object(h.jsx)("div",{className:"w-full pt-1 pb-5",children:Object(h.jsx)("div",{className:"bg-yellow-500 text-white overflow-hidden rounded-full w-20 h-20 -mt-16 mx-auto shadow-lg flex justify-center items-center",children:Object(h.jsx)(d.a,{className:"w-2/3"})})}),Object(h.jsx)("div",{className:"mb-10",children:Object(h.jsx)("h2",{className:"text-center font-bold text-xl uppercase",children:"Secure payment info"})}),Object(h.jsxs)("form",{onSubmit:G,className:"w-full",children:[Object(h.jsx)(i.CardElement,{className:"".concat(m.a.input),options:{style:{base:{color:"black",fontFamily:"Roboto, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"black"}},invalid:{color:"#EF4444",iconColor:"#EF4444"}}},onChange:z}),Object(h.jsx)("button",{disabled:C||E||_,className:"".concat(m.a.submit," ").concat(m.a.button),children:Object(h.jsx)("span",{className:m.a["button-text"],children:C?Object(h.jsx)("div",{className:m.a.spinner,id:"spinner"}):"Pay now"})}),Object(h.jsx)("div",{className:"".concat(!v&&"invisible"," card-error text-center text-red-600 font-bold mt-2"),role:"alert",children:v||"No error"})]}),Object(h.jsx)("div",{className:"px- mt-6 flex justify-end",children:Object(h.jsx)("img",{src:"https://res.cloudinary.com/ngasco/image/upload/v1623952029/bonsai_background/logo-stripe_ouoag3.png",alt:"Logos of Visa, MasterCard, American Express, and Discover",className:"w-1/3"})})]})}}}]);
//# sourceMappingURL=3.f42ca74e.chunk.js.map